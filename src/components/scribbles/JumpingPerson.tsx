import { useCallback, useEffect, useRef, useState } from "react";
import { motion, useInView } from "framer-motion";

export default function JumpingPerson() {
	const ref = useRef<HTMLDivElement>(null)
	const isInView = useInView(ref)
	const [personState, setPersonState] = useState<'standing' | 'preparing' | 'jumping'>('standing')

	const handleStateChange = useCallback(() => {
		if (isInView) {
			if (personState === 'standing') {
				setTimeout(() => setPersonState('preparing'), 3000)
				setTimeout(() => setPersonState('jumping'), 3500)
			}
		}
	}, [isInView, personState])

	useEffect(() => {
		handleStateChange()
	}, [isInView, handleStateChange])


	return (
		<div className='absolute bottom-0' ref={ref}>
			{personState === 'standing' && (
				<svg
					className='w-8 sm:w-11'
					viewBox="0 0 46 104"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path d="M18.6881 7.12365C27.6894 -5.79664 44.1068 15.007 32.5703 23.5225C23.6058 30.1401 13.0811 19.8254 17.2899 10.8507" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M32.0915 33.3269C30.3706 33.3269 24.2527 33.0901 21.497 32.6563C19.7154 32.3759 18.3908 31.9703 17.8332 31.9061C17.414 31.8583 16.9936 31.8272 16.5736 31.7803C16.3506 31.7558 16.1276 31.7296 15.9051 31.6966C15.8609 31.6904 15.8163 31.687 15.7713 31.687C15.5075 31.687 15.239 31.7993 15.0482 32.0377C14.7756 32.3788 14.7089 32.8646 14.7187 33.3269C14.7283 33.7646 14.8244 34.2118 14.9109 34.6336C14.9882 35.0067 16.4114 41.1645 16.8336 42.2779C17.17 43.1647 20.5803 58.5354 20.6892 59.2656C20.6953 59.3664 20.698 59.466 20.6978 59.5658" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M20.7782 59.9697C20.6003 60.5749 17.9662 73.8083 17.4697 76.358C17.209 77.7007 16.9491 79.0433 16.6917 80.3866C16.5879 80.9295 16.495 81.4772 16.3749 82.0171C16.1898 82.848 16.0049 83.6798 15.8198 84.5106C15.6888 85.1021 15.5065 85.6799 15.3422 86.2606C15.1807 86.8357 15.0146 87.4048 14.8323 87.9718C14.4288 89.2258 14.0046 90.476 13.6291 91.7397C13.4234 92.4323 13.2076 93.1231 13.0191 93.8215C12.8141 94.5813 12.6138 95.3411 12.4225 96.1047C12.135 97.2498 11.8695 98.4034 11.5608 99.5428C11.4691 99.561 11.3771 99.5787 11.2851 99.5993C11.0864 99.6439 10.8889 99.6888 10.6904 99.7336C10.3817 99.8036 8.41907 99.7468 8.25293 99.9697" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M33.3026 34.5151C33.2391 34.6878 33.207 34.8729 33.2064 35.073C33.073 36.7481 32.932 38.4212 32.7931 40.0953C32.567 42.6202 32.3433 45.1451 32.0938 47.6654C31.9728 48.8938 31.8547 50.1216 31.7101 51.3434C31.6108 52.1896 31.511 53.035 31.411 53.8802C31.3494 54.4058 31.2542 54.9229 31.1719 55.4409C31.0848 55.9913 31.0103 56.5508 30.9026 57.0936C30.7737 57.7397 30.6544 58.3923 30.5127 59.0318C30.3838 59.6142 30.2536 60.1961 30.1222 60.7778C30.1052 60.7627 30.0878 60.7484 30.0703 60.7338" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M30.8789 61.1816C30.9515 62.2055 31.9986 68.3905 32.2646 69.7249C32.8663 72.7438 33.4647 75.7629 34.0579 78.784C34.549 81.2802 35.0403 83.7794 35.5955 86.2575C35.9297 87.7469 36.2654 89.234 36.6159 90.7193C36.9196 92.007 37.2234 93.2967 37.49 94.5964C37.5111 94.6987 39.0324 99.9788 39.1176 100.102C39.7822 100.998 41.3838 100.768 41.5087 100.702C41.6016 100.656 41.6953 100.61 41.788 100.564" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M15.4368 32.1267C15.3654 32.1025 15.2923 32.0908 15.2198 32.0908C15.0031 32.0908 14.79 32.1955 14.6339 32.3859C14.3696 32.7095 14.1034 33.0303 13.852 33.3699C13.5924 33.7204 4.33886 41.5061 4.21802 41.6363C3.94955 41.9263 3.73465 42.2738 3.53034 42.6312C3.31938 43.0005 3.17674 43.4423 3.0752 43.8724C2.97471 44.2992 2.98758 44.7541 3.04032 45.187C3.15078 46.0886 19.1778 56.4157 19.662 56.7314C19.8985 56.886 20.1354 57.0415 20.3737 57.1938C20.3594 57.2274 20.3455 57.2614 20.332 57.2955C20.0797 57.9279 19.9273 58.6388 19.8883 59.3417C19.8517 59.9921 19.9475 60.6246 20.2355 61.1817" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M32.3457 33.3027C32.5829 33.8155 41.7188 42.5454 42.2677 43.6882C42.3929 43.9479 42.5107 44.2114 42.6238 44.4789C42.6974 44.6547 42.7633 44.8442 42.8249 45.0259C42.8466 45.0888 42.8698 45.1514 42.8891 45.2152C42.9435 45.3923 43.0125 45.6405 42.9973 45.8261C42.986 45.9773 42.97 46.1276 42.9501 46.2772C42.9018 46.4216 42.8497 46.5634 42.7937 46.7042C42.6966 46.8737 42.6006 47.0525 42.4762 47.1972C42.2181 47.495 41.9119 47.7498 41.6065 47.9744C41.2482 48.237 40.8841 48.4893 40.5275 48.7546C40.0544 49.1077 33.8474 54.7063 33.4826 54.9555C33.1214 55.2027 32.7345 55.3861 32.3457 55.5627C32.4415 55.7174 32.5248 55.8825 32.5921 56.0564C32.6779 56.2771 32.754 56.4951 32.8092 56.7282C32.839 56.926 32.8575 57.125 32.8647 57.3247C32.8445 57.5958 32.8134 57.8574 32.7532 58.1202C32.5825 58.866 31.9083 59.3171 31.2822 59.1116" stroke="black" strokeOpacity="0.9" strokeWidth="5.16129" strokeLinecap="round" strokeLinejoin="round" />
				</svg>
			)}


			{personState === 'preparing' && (
				<motion.svg
					initial={{ y: 0 }}
					animate={{ y: 16 }}
					className='w-12 sm:w-16'
					viewBox="0 0 61 93"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path d="M39.2581 23.1368C46.8747 15.1213 61.4271 22.2688 57.1533 33.6321C54.3484 41.0873 39.7839 50.4249 36.4502 30.4838" stroke="black" strokeOpacity="0.9" strokeWidth="5.05263" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M9.57558 3C8.18212 4.40173 15.1691 15.3075 30.5364 35.7173C18.7583 26.8829 9.57951 21.637 3 19.9798" stroke="black" strokeOpacity="0.9" strokeWidth="5.05263" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M30.2925 35.668C16.3978 41.1943 9.06959 55.4495 11.0649 56.9318C18.7276 62.6267 35.6241 61.1412 36.5392 63.268C37.6606 65.8741 37.0623 68.0243 34.8831 75.2218C34.2639 77.2671 33.2745 79.4241 32.399 81.3754C31.5603 83.2468 30.4606 85.7577 29.0869 87.1189L31.157 89.8097" stroke="black" strokeOpacity="0.9" strokeWidth="5.05263" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M36.6549 64.5088C31.7876 73.6013 25.7575 80.2988 15.6748 81.958" stroke="black" strokeOpacity="0.9" strokeWidth="5.05263" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M15.6747 81.5215L13.4893 85.0113" stroke="black" strokeOpacity="0.9" strokeWidth="5.05263" strokeLinecap="round" strokeLinejoin="round" />
				</motion.svg>
			)}

			{personState === 'jumping' && (
				<motion.svg
					initial={{ y: 16 }}
					animate={{ y: -42 }}
					transition={{ duration: 0.1 }}
					className='mb-4 sm:mb-0 sm:w-12 w-9'
					viewBox="0 0 47 124"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path d="M4.8458 34.3776C15.6859 22.7558 26.1856 26.046 28.2671 34.8099C30.3062 43.395 23.984 49.4702 19.6558 50.2951C9.64819 52.203 -0.990513 38.1093 6.54642 33.0825" stroke="black" strokeOpacity="0.9" strokeWidth="6.11382" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M6.95074 52.7451C6.08861 53.3892 5.99551 67.6476 5.99551 67.6476C5.99551 67.6476 5.60055 80.4542 8.51358 85.2976C8.66721 85.552 21.9407 85.6874 22.7342 85.0953C23.1484 84.7863 19.1784 68.9851 20.4998 59.77" stroke="black" strokeOpacity="0.9" strokeWidth="6.11382" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M6.88882 52.5762C1.37748 40.8319 6.33247 24.5828 15.2177 15.9303C19.4747 11.7858 24.728 9.06213 29.0311 5.43058C35.9684 -0.424266 32.1977 14.19 29.0311 5.0026" stroke="black" strokeOpacity="0.9" strokeWidth="6.11382" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M21.1885 57.9761C34.2143 74.5785 36.4338 58.1219 43.7365 45.0107" stroke="black" strokeOpacity="0.9" strokeWidth="6.11382" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M8.66992 86.1802C9.75674 88.6667 16.3649 113.661 24.1554 113.661C26.7059 113.661 19.1705 90.2884 24.1554 97.2501" stroke="black" strokeOpacity="0.9" strokeWidth="6.11382" strokeLinecap="round" strokeLinejoin="round" />
					<path d="M24.1553 86.1084C26.6596 88.1091 30.305 90.4019 32.8914 92.294C35.8253 94.439 38.176 94.6201 40.8131 97.2501C42.9117 99.343 26.7312 114.406 32.8914 120.549" stroke="black" strokeOpacity="0.9" strokeWidth="6.11382" strokeLinecap="round" strokeLinejoin="round" />
				</motion.svg>
			)}
		</div>
	)
}